let historyData = JSON.parse(localStorage.getItem('billHistory')) || [];
function showSection(id){document.querySelectorAll('.section').forEach(sec=>sec.classList.remove('active-section'));document.getElementById(id).classList.add('active-section');document.querySelectorAll('.sidebar li').forEach(li=>li.classList.remove('active'));event.target.classList.add('active');if(id==='history')loadHistory();if(id==='reports')loadChart();}
function calculateBill(){const name=document.getElementById('name').value;const units=parseFloat(document.getElementById('units').value);if(!name||!units){alert('Please enter both fields!');return;}let amount;if(units<=100)amount=units*1.5;else if(units<=200)amount=100*1.5+(units-100)*2.5;else if(units<=500)amount=100*1.5+100*2.5+(units-200)*4.0;else amount=100*1.5+100*2.5+300*4.0+(units-500)*6.0;amount+=50;amount=amount.toFixed(2);document.getElementById('result').innerHTML=`<h2>Bill Summary</h2><p><strong>Customer:</strong> ${name}</p><p><strong>Units:</strong> ${units}</p><p><strong>Total Amount:</strong> ₹${amount}</p>`;historyData.push({name,units,amount});localStorage.setItem('billHistory',JSON.stringify(historyData));}
function loadHistory(){const table=document.querySelector('#historyTable tbody');table.innerHTML='';historyData.forEach(entry=>{const row=`<tr><td>${entry.name}</td><td>${entry.units}</td><td>${entry.amount}</td></tr>`;table.innerHTML+=row;});}
function loadChart(){const ctx=document.getElementById('reportChart');const labels=historyData.map(h=>h.name);const data=historyData.map(h=>h.amount);new Chart(ctx,{type:'bar',data:{labels,datasets:[{label:'Amount (₹)',data,borderWidth:1}]},options:{scales:{y:{beginAtZero:true}}}});}
function toggleTheme(){document.body.classList.toggle('dark');}
